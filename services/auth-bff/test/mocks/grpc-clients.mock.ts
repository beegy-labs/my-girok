export const createMockIdentityGrpcClient = () => ({
  getAccount: jest.fn(),
  getAccountByEmail: jest.fn(),
  createAccount: jest.fn(),
  validatePassword: jest.fn(),
  createSession: jest.fn(),
  recordLoginAttempt: jest.fn(),
  setupMfa: jest.fn(),
  verifyMfaSetup: jest.fn(),
  verifyMfaCode: jest.fn(),
  disableMfa: jest.fn(),
  getBackupCodes: jest.fn(),
  regenerateBackupCodes: jest.fn(),
  useBackupCode: jest.fn(),
  changePassword: jest.fn(),
  revokeAllSessions: jest.fn(),
});

export const createMockAuthGrpcClient = () => ({
  adminLogin: jest.fn(),
  adminLoginMfa: jest.fn(),
  adminValidateSession: jest.fn(),
  adminRefreshSession: jest.fn(),
  adminLogout: jest.fn(),
  adminRevokeAllSessions: jest.fn(),
  adminGetActiveSessions: jest.fn(),
  adminSetupMfa: jest.fn(),
  adminVerifyMfa: jest.fn(),
  adminDisableMfa: jest.fn(),
  adminRegenerateBackupCodes: jest.fn(),
  adminChangePassword: jest.fn(),
  getOperatorAssignment: jest.fn(),
  getOperatorAssignmentPermissions: jest.fn(),
  checkPermission: jest.fn(),
  getOperatorPermissions: jest.fn(),
});

export const createMockSessionService = () => ({
  createSession: jest.fn(),
  getSession: jest.fn(),
  validateSession: jest.fn(),
  setMfaVerified: jest.fn(),
  refreshSession: jest.fn(),
  destroySession: jest.fn(),
  getActiveSessions: jest.fn(),
  revokeSession: jest.fn(),
  revokeAllOtherSessions: jest.fn(),
  needsRefresh: jest.fn(),
  getSessionWithTokens: jest.fn(),
  getDeviceFingerprint: jest.fn().mockReturnValue('mock-fingerprint'),
  extractMetadata: jest.fn().mockReturnValue({
    userAgent: 'test-agent',
    ipAddress: '127.0.0.1',
    deviceType: 'desktop',
  }),
});
