# Agent-Driven Development (ADD) Policy

> Multi-Agent Orchestration for Autonomous Execution | **Last Updated**: 2026-01-22

## Definition

ADD is the execution phase where multiple LLM agents autonomously implement tasks generated by SDD. Tasks are distributed across agents (Claude Code, Gemini CLI, etc.) with a main agent orchestrating results.

**Core Principle**: Execute approved SDD tasks through multi-agent collaboration, with self-resolution capabilities and automatic knowledge capitalization.

## CDD ↔ SDD ↔ ADD Relationship

```
CDD (HOW - Patterns)
    ↓ Referenced by
SDD (WHAT - Tasks)
    ↓ Executed by
ADD (DO - Implementation)
    ↓ Feedback to
CDD (Knowledge Update)
```

| Phase | Focus              | Input          | Output             |
| ----- | ------------------ | -------------- | ------------------ |
| CDD   | Patterns & Context | Experience     | Documentation      |
| SDD   | Task Planning      | Roadmap        | tasks/{scope}.md   |
| ADD   | Execution          | Approved tasks | Code & CDD updates |

## Architecture

### Multi-Terminal Orchestration

```
┌─────────────────────────────────────────────────────────────────┐
│                      Main Agent (Orchestrator)                   │
│  - Distributes tasks from tasks/{scope}.md                      │
│  - Collects results from sub-agents                             │
│  - Performs cross-validation (Consensus)                        │
│  - Manages parallel/sequential execution                        │
└─────────────────────────────────────────────────────────────────┘
        │                    │                    │
        ▼                    ▼                    ▼
┌──────────────┐    ┌──────────────┐    ┌──────────────┐
│  Terminal 1  │    │  Terminal 2  │    │  Terminal 3  │
│  Claude Code │    │  Gemini CLI  │    │  Claude Code │
│  (Task A)    │    │  (Task B)    │    │  (Task C)    │
└──────────────┘    └──────────────┘    └──────────────┘
```

### Agent Types

| Agent       | Tool        | Strengths                          | Use Case                    |
| ----------- | ----------- | ---------------------------------- | --------------------------- |
| Claude Code | CLI         | Complex reasoning, code generation | Architecture, complex logic |
| Gemini CLI  | CLI         | Fast iteration, broad knowledge    | Boilerplate, documentation  |
| Local Agent | Ollama/vLLM | Cost optimization, privacy         | Consistency checks, reviews |

## Workflow

```
┌─────────────────────────────────────────────────────────────────┐
│  1. [System] Task Distribution                                  │
│     Main agent reads approved tasks/{scope}.md                  │
│     Distributes tasks based on execution mode (parallel/seq)    │
│     Assigns agents based on task complexity                     │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│  2. [LLM] Autonomous Implementation                             │
│     Sub-agents implement assigned tasks                         │
│     Reference CDD (Tier 1-2) for patterns                       │
│     Report progress to main agent                               │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│  3. [LLM] Self-Resolution (On Problems)                         │
│     Does NOT immediately interrupt human                        │
│     Summons peer agents for consensus                           │
│     Resolves through AI collaboration + test execution          │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│  4. [Human] Final Intervention (Only if consensus fails)        │
│     System generates 'Incident Report'                          │
│     Commander does NOT fix code directly                        │
│     Instead: Updates SDD (tasks) or CDD (patterns)              │
│     Then restarts affected agents                               │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│  5. [System] Experience Capitalization (Distillation)           │
│     All trials and problem-solving recorded                     │
│     Extract abstracted principles                               │
│     Auto-update CDD (Tier 1-2)                                  │
│     Prevents context bloat                                      │
└─────────────────────────────────────────────────────────────────┘
```

## Task Execution from SDD

ADD reads `tasks/{scope}.md` and executes based on designated modes:

```markdown
# From tasks/{scope}.md

### Phase 1 (Parallel) → ADD distributes to multiple agents

- [ ] Task A → Agent 1 (Claude Code)
- [ ] Task B → Agent 2 (Gemini CLI)
- [ ] Task C → Agent 3 (Claude Code)

### Phase 2 (Sequential) → ADD executes in order

- [ ] Task D → Wait for Phase 1 completion
- [ ] Task E → Wait for Task D completion
```

## Self-Resolution Protocol

When an agent encounters a problem:

```yaml
step_1:
  action: 'Attempt self-resolution'
  methods:
    - Re-read CDD for patterns
    - Search codebase for similar solutions
    - Run tests to validate assumptions

step_2:
  condition: 'Self-resolution fails'
  action: 'Request peer consensus'
  process:
    - Describe problem to other agents
    - Each agent proposes solution
    - Vote on best approach
    - Implement consensus solution

step_3:
  condition: 'Consensus fails (3+ attempts)'
  action: 'Generate Incident Report'
  content:
    - Problem description
    - Attempted solutions
    - Agent votes and rationale
    - Recommended human action (SDD or CDD update)
```

## Experience Capitalization (Distillation)

After task completion or incident resolution:

```
Raw Experience
    ↓
Extract Patterns
    ↓
Generalize Principles
    ↓
Update CDD (Tier 1-2)
    ↓
Future agents benefit
```

### What Gets Capitalized

| Category              | Example                          | CDD Update              |
| --------------------- | -------------------------------- | ----------------------- |
| New Pattern           | Discovered efficient API pattern | `.ai/guides/`           |
| Bug Fix               | Common error and solution        | `docs/llm/guides/`      |
| Architecture Decision | Why approach X over Y            | `docs/llm/policies/`    |
| Performance Insight   | Optimization technique           | `.ai/best-practices.md` |

## Local Infrastructure (Future)

### Consistency Check Agent

```yaml
hardware: 'Ryzen AI 300 series (Strix) + 128GB RAM'
schedule: 'Daily at 3AM'
tasks:
  - CDD ↔ Code consistency validation
  - Detect drift between documentation and implementation
  - Generate discrepancy reports
  - Auto-suggest CDD updates
```

### Cost Optimization

```
Task Classification:
  - Complex (architecture, logic) → Claude/Gemini API
  - Simple (formatting, docs) → Local LLM
  - Validation (tests, checks) → Local LLM
```

## Human Intervention Policy

**Commander does NOT write code directly.**

When intervention is required:

1. Review Incident Report
2. Identify root cause (missing pattern? unclear spec?)
3. Update appropriate layer:
   - Missing pattern → Update CDD
   - Unclear requirement → Update SDD (scope or tasks)
4. Restart affected agents

## Metrics

| Metric               | Target | Purpose                  |
| -------------------- | ------ | ------------------------ |
| Self-Resolution Rate | 90%+   | Validate autonomy        |
| Consensus Success    | 95%+   | Validate collaboration   |
| Human Interventions  | <5%    | Validate system maturity |
| CDD Auto-Updates     | Track  | Validate learning        |

## Current Status

- [x] Single agent execution (Claude Code)
- [x] Basic task distribution
- [ ] Multi-terminal orchestration (In Progress)
- [ ] Cross-agent consensus protocol
- [ ] Local consistency check agent
- [ ] Automatic CDD update pipeline

## References

- CDD Policy: `docs/llm/policies/cdd.md`
- SDD Policy: `docs/llm/policies/sdd.md`
- Methodology: `docs/llm/policies/development-methodology.md`
