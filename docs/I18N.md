# Internationalization (i18n) Guide

This document describes the internationalization setup and usage in the my-girok project.

## Supported Languages

The application currently supports three languages:

- **Korean (ko)** - Default language
- **English (en)** - Fallback language
- **Japanese (ja)**

## Technology Stack

- **Library**: [react-i18next](https://react.i18next.com/)
- **Core**: [i18next](https://www.i18next.com/)
- **Storage**: localStorage for language preference persistence

## Project Structure

```
apps/web-main/src/
├── i18n/
│   ├── config.ts              # i18n initialization and configuration
│   └── locales/
│       ├── ko.json            # Korean translations
│       ├── en.json            # English translations
│       └── ja.json            # Japanese translations
├── components/
│   └── LanguageSwitcher.tsx   # Language switcher component
└── main.tsx                   # i18n import for initialization
```

## Configuration

### i18n Setup (`src/i18n/config.ts`)

```typescript
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import en from './locales/en.json';
import ko from './locales/ko.json';
import ja from './locales/ja.json';

const resources = {
  en: { translation: en },
  ko: { translation: ko },
  ja: { translation: ja },
};

i18n
  .use(initReactI18next)
  .init({
    resources,
    lng: localStorage.getItem('language') || 'ko', // Default language
    fallbackLng: 'en',
    interpolation: {
      escapeValue: false,
    },
  });

export default i18n;
```

### Key Configuration Options

- **`lng`**: Default language (Korean), reads from localStorage if available
- **`fallbackLng`**: English as fallback when translation is missing
- **`interpolation.escapeValue`**: Set to false for React (handles escaping automatically)

## Translation Files

### File Structure

All translation files follow the same JSON structure:

```json
{
  "nav": {
    "login": "...",
    "register": "...",
    "logout": "..."
  },
  "home": {
    "title": "...",
    "subtitle": "...",
    ...
  },
  "auth": {
    ...
  },
  "resume": {
    ...
  }
}
```

### Current Translation Namespaces

1. **nav**: Navigation related text (login, register, logout)
2. **home**: Home page content (titles, descriptions, app cards)
3. **auth**: Authentication forms (email, password, buttons, messages)
4. **resume**: Resume-related text (edit, preview, view public profile)

### Example Translations

#### Korean (`ko.json`)
```json
{
  "nav": {
    "login": "로그인",
    "register": "회원가입",
    "logout": "로그아웃"
  }
}
```

#### English (`en.json`)
```json
{
  "nav": {
    "login": "Login",
    "register": "Register",
    "logout": "Logout"
  }
}
```

#### Japanese (`ja.json`)
```json
{
  "nav": {
    "login": "ログイン",
    "register": "新規登録",
    "logout": "ログアウト"
  }
}
```

## Usage in Components

### Basic Usage

```typescript
import { useTranslation } from 'react-i18next';

function MyComponent() {
  const { t } = useTranslation();

  return (
    <div>
      <button>{t('nav.login')}</button>
      <h1>{t('home.title')}</h1>
    </div>
  );
}
```

### Language Switching

```typescript
import { useTranslation } from 'react-i18next';

function LanguageSwitcher() {
  const { i18n } = useTranslation();

  const changeLanguage = (lng: string) => {
    i18n.changeLanguage(lng);
    localStorage.setItem('language', lng);
  };

  return (
    <button onClick={() => changeLanguage('ko')}>한국어</button>
  );
}
```

### Checking Current Language

```typescript
const { i18n } = useTranslation();
const currentLanguage = i18n.language; // 'ko', 'en', or 'ja'
```

## Language Switcher Component

The `LanguageSwitcher` component is located in the Navbar and provides three buttons:

- **한국어** (Korean)
- **English** (English)
- **日本語** (Japanese)

The selected language button is highlighted in blue, and the user's selection is persisted in localStorage.

```typescript
<LanguageSwitcher />
```

## Adding New Translations

### Step 1: Add Translation Keys

Add the same key to all three language files:

**`ko.json`**
```json
{
  "newFeature": {
    "title": "새 기능"
  }
}
```

**`en.json`**
```json
{
  "newFeature": {
    "title": "New Feature"
  }
}
```

**`ja.json`**
```json
{
  "newFeature": {
    "title": "新機能"
  }
}
```

### Step 2: Use in Component

```typescript
const { t } = useTranslation();
<h1>{t('newFeature.title')}</h1>
```

## Best Practices

### 1. Always Provide All Languages

When adding new translation keys, **always add translations for all supported languages** (ko, en, ja).

```json
// ❌ Bad: Only Korean
{
  "button": {
    "submit": "제출"
  }
}

// ✅ Good: All languages
// ko.json: "제출"
// en.json: "Submit"
// ja.json: "送信"
```

### 2. Use Meaningful Key Names

Use clear, hierarchical key names that describe the content:

```json
// ❌ Bad
{
  "text1": "Login",
  "btn2": "Submit"
}

// ✅ Good
{
  "nav": {
    "login": "Login"
  },
  "form": {
    "submit": "Submit"
  }
}
```

### 3. Group Related Translations

Group related translations under the same namespace:

```json
{
  "auth": {
    "login": "Login",
    "register": "Register",
    "forgotPassword": "Forgot Password?",
    "resetPassword": "Reset Password"
  }
}
```

### 4. Keep Translation Files Synchronized

Ensure all language files have the same structure and keys. Missing keys will fall back to English.

### 5. Use Interpolation for Dynamic Content

```typescript
// Translation file
{
  "welcome": "Welcome, {{name}}!"
}

// Component
t('welcome', { name: user.name })
```

## Testing

### Verify Translations

1. Switch between languages using the LanguageSwitcher
2. Check that all text updates correctly
3. Verify localStorage persistence by refreshing the page

### Check for Missing Translations

If a translation key is missing, i18next will:
1. First try the current language
2. Then fall back to English (fallbackLng)
3. Finally display the key itself if not found

## Language Detection Flow

1. **First Load**:
   - Check localStorage for saved language preference
   - If not found, use Korean (default)

2. **User Changes Language**:
   - Update i18n language
   - Save preference to localStorage

3. **Subsequent Loads**:
   - Read from localStorage
   - Apply saved language automatically

## Troubleshooting

### Translation Not Showing

1. **Check key exists in all language files**
   ```bash
   grep -r "yourKey" apps/web-main/src/i18n/locales/
   ```

2. **Verify i18n is imported in main.tsx**
   ```typescript
   import './i18n/config';
   ```

3. **Check browser console for i18next warnings**

### Language Not Persisting

1. **Verify localStorage is being set**
   ```typescript
   localStorage.setItem('language', lng);
   ```

2. **Check browser's localStorage**
   - Open DevTools → Application → Local Storage
   - Look for 'language' key

### Fallback Not Working

1. **Verify fallbackLng is set to 'en'**
   ```typescript
   fallbackLng: 'en'
   ```

2. **Ensure English translations exist**
   - Check `en.json` has the key

## Future Enhancements

Potential improvements for the i18n system:

1. **Language Detection**
   - Auto-detect browser language
   - Use `i18next-browser-languagedetector`

2. **More Languages**
   - Chinese (Simplified/Traditional)
   - Spanish
   - French

3. **Translation Management**
   - Use translation management platform (e.g., Lokalise, Crowdin)
   - Automated translation updates

4. **Lazy Loading**
   - Load translation files on demand
   - Reduce initial bundle size

5. **Pluralization**
   - Handle singular/plural forms
   - Use i18next pluralization features

6. **Date/Number Formatting**
   - Locale-specific formatting
   - Use `Intl` API or `date-fns` with locales

## Resources

- [react-i18next Documentation](https://react.i18next.com/)
- [i18next Documentation](https://www.i18next.com/)
- [i18next Best Practices](https://www.i18next.com/principles/best-practices)

---

**Last Updated**: 2025-11-09
**Maintainer**: Engineering Team
