# SSOT Strategy

> Single Source of Truth for all packages and services

## Overview

The SSOT (Single Source of Truth) strategy ensures consistency across the codebase by centralizing definitions of design tokens, constants, types, and configurations.

## Frontend: Design Tokens (Tailwind CSS 4)

Design tokens flow from CSS custom properties through Tailwind utility classes to components:

```
tokens.css (@theme) -> Tailwind Utility Classes -> Components
```

### Token Mappings

| Utility            | Token                       | Value    |
| ------------------ | --------------------------- | -------- |
| `rounded-soft`     | `--radius-soft`             | 8px      |
| `font-serif-title` | `--font-family-serif-title` | Playfair |
| `tracking-brand`   | `--letter-spacing-brand`    | 0.3em    |
| `min-h-input`      | `--min-height-input`        | 48px     |

### 8pt Grid System

The design system follows an 8-point grid for consistent spacing:

| Class  | Value | Grid |
| ------ | ----- | ---- |
| `py-2` | 8px   | OK   |
| `py-3` | 12px  | NO   |
| `py-4` | 16px  | OK   |

Only use spacing values that are multiples of 8px for visual consistency.

### Design Token Rules

| DO               | DON'T                          |
| ---------------- | ------------------------------ |
| `rounded-soft`   | `rounded-lg`, `rounded-[24px]` |
| `tracking-brand` | `tracking-widest`              |
| `min-h-input`    | `min-h-[48px]`                 |

Always use semantic token names instead of arbitrary values. This ensures consistency and makes theme changes easier.

## Backend: Constants

### Shared Constants

```
@my-girok/nest-common (Shared)
  CacheTTL, ID, PaginationDefaults, RetryConfig
```

### Service-Specific Constants

```
identity-service/common/constants (Service-specific)
  SESSION, RATE_LIMIT, MFA, ACCOUNT_SECURITY, DSR_DEADLINE_DAYS
```

### Decision Tree

```
Multi-service? -> @my-girok/nest-common
  |
  NO -> Domain-specific? -> service/common/constants/
          |
          NO -> Environment variable
```

Use this decision tree to determine where to place new constants.

## Types: @my-girok/types

| Category       | SSOT Location    |
| -------------- | ---------------- |
| Auth Enums     | @my-girok/types  |
| Identity Enums | Prisma generated |
| Legal Enums    | @my-girok/types  |

Types that are used across multiple services belong in `@my-girok/types`. Service-specific types generated by Prisma remain in the service.

## Event Naming

```typescript
// SCREAMING_SNAKE_CASE
('USER_REGISTERED', 'ACCOUNT_CREATED', 'SESSION_STARTED');
```

All event names use SCREAMING_SNAKE_CASE for consistency and clarity.

## Key Files

```
packages/design-tokens/src/tokens.css
packages/types/src/
packages/nest-common/src/
services/identity-service/src/common/constants/
```

---

**LLM Reference**: `docs/llm/ssot.md`
