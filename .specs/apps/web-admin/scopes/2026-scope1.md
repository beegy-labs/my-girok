# Scope: 2026-Scope1 (Email Service)

> **WHEN**: Work range from roadmap | Human defines range, LLM documents

## Status

| Phase            | Status      | Date       |
| ---------------- | ----------- | ---------- |
| Scope Definition | ✅ Complete | 2026-01-22 |
| Task Generation  | ✅ Complete | 2026-01-22 |
| Human Approval   | ⏳ Pending  | -          |
| Implementation   | ⏳ Pending  | -          |

## Target

Build global email service infrastructure as the foundation for all notifications and invitations across the platform.

## Period

2026-01 ~ 2026-02 (Scope 1 of Phase 1)

## Items from Roadmap

| Priority | Feature                   | Description                     | Status |
| -------- | ------------------------- | ------------------------------- | ------ |
| P0       | Proto definition          | gRPC interface for mail-service | ⏳     |
| P0       | mail-service creation     | NestJS gRPC server              | ⏳     |
| P0       | i18n templates            | Multi-language email templates  | ⏳     |
| P0       | Kafka integration         | Email send queuing via Redpanda | ⏳     |
| P0       | AWS SES Integration       | Actual email delivery           | ⏳     |
| P0       | SES Webhook               | Open/Click/Bounce tracking      | ⏳     |
| P0       | audit-service integration | Event tracking                  | ⏳     |
| P0       | Database design           | EmailLog, Inbox tables          | ⏳     |
| P0       | Service-level tracking    | sourceService, fromEmail        | ⏳     |
| P0       | Containerization          | Dockerfile, docker-compose      | ⏳     |
| P0       | Helm Chart                | K8s deployment                  | ⏳     |
| P0       | auth-bff integration      | gRPC Client                     | ⏳     |

## Architecture Overview

```
┌─────────────┐      gRPC       ┌──────────────┐      Kafka      ┌─────────┐
│  auth-bff   │ ──────────────> │ mail-service │ ──────────────> │ AWS SES │
│  (+ others) │                 │              │                 └─────────┘
└─────────────┘                 │  - i18n      │
                                │  - Templates │
                                │  - Tracking  │
                                └──────────────┘
                                       │
                                       ▼
                                ┌──────────────┐
                                │  PostgreSQL  │
                                │  - EmailLog  │
                                │  - Inbox     │
                                └──────────────┘
```

## Success Criteria

- [ ] mail-service gRPC server working
- [ ] i18n templates (ko, en) working
- [ ] Kafka message publish/consume working
- [ ] AWS SES email delivery success
- [ ] EmailLog table storing send history
- [ ] Service-level tracking (sourceService, fromEmail) working
- [ ] auth-bff can call mail-service via gRPC
- [ ] Helm deploy success (with Kafka topic config)
- [ ] 80% test coverage
- [ ] CDD documentation updated

## Deliverables

| Deliverable      | Path                                     |
| ---------------- | ---------------------------------------- |
| mail-service     | `services/mail-service/`                 |
| Proto definition | `packages/proto/mail/v1/mail.proto`      |
| gRPC Client      | `packages/nest-common/` (MailGrpcClient) |
| Helm Chart       | `services/mail-service/helm/`            |
| Dockerfile       | `services/mail-service/Dockerfile`       |
| docker-compose   | `docker-compose.yml.example`             |
| CDD Indicator    | `.ai/services/mail-service.md`           |
| CDD SSOT         | `docs/llm/services/mail-service.md`      |

## References

- **Roadmap**: `roadmap.md`
- **Tasks**: `tasks/2026-scope1.md`
- **Feature Spec**: `menu-structure.md` (Section 4.5 Identity → Provisioning)
